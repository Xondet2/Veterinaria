<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="DESCRIPTION" height="1297px" preserveAspectRatio="none" style="width:1137px;height:1297px;background:#FFFFFF;" version="1.1" viewBox="0 0 1137 1297" width="1137px" zoomAndPan="magnify"><title>Arquitectura SGV (Next.js + Spring Boot)</title><defs/><g><g class="title" data-source-line="2"><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="271.8652" x="425.9641" y="24.5332">Arquitectura SGV (Next.js + Spring Boot)</text></g><!--cluster FE--><g class="cluster" data-entity="FE" data-source-line="6" data-uid="ent0003" id="cluster_FE"><path d="M92.5,186.1094 L232.7412,186.1094 A3.75,3.75 0 0 1 235.2412,188.6094 L242.2412,209.7188 L299.5,209.7188 A2.5,2.5 0 0 1 302,212.2188 L302,488.6094 A2.5,2.5 0 0 1 299.5,491.1094 L92.5,491.1094 A2.5,2.5 0 0 1 90,488.6094 L90,188.6094 A2.5,2.5 0 0 1 92.5,186.1094" fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="90" x2="242.2412" y1="209.7188" y2="209.7188"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="139.2412" x="94" y="202.6426">Frontend (Next.js 15)</text></g><!--cluster BE--><g class="cluster" data-entity="BE" data-source-line="12" data-uid="ent0007" id="cluster_BE"><path d="M290.5,549.1094 L466.5205,549.1094 A3.75,3.75 0 0 1 469.0205,551.6094 L476.0205,572.7187 L969.5,572.7187 A2.5,2.5 0 0 1 972,575.2187 L972,1158.9694 A2.5,2.5 0 0 1 969.5,1161.4694 L290.5,1161.4694 A2.5,2.5 0 0 1 288,1158.9694 L288,551.6094 A2.5,2.5 0 0 1 290.5,549.1094" fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="288" x2="476.0205" y1="572.7187" y2="572.7187"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="175.0205" x="292" y="565.6426">Backend (Spring Boot 3.3)</text></g><!--cluster C--><g class="cluster" data-entity="C" data-source-line="13" data-uid="ent0008" id="cluster_C"><rect fill="none" height="227" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:1;" width="501" x="328" y="894.4694"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="74.6758" x="541.1621" y="911.0026">Controllers</text></g><!--entity UI--><g class="entity" data-entity="UI" data-source-line="7" data-uid="ent0004" id="entity_UI"><rect fill="#F1F1F1" height="37.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="118.0342" x="106" y="222.1094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="98.0342" x="116" y="246.6426">UI (App Router)</text></g><!--entity RoleGuard--><g class="entity" data-entity="RoleGuard" data-source-line="8" data-uid="ent0005" id="entity_RoleGuard"><rect fill="#F1F1F1" height="37.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="87.7031" x="113" y="321.1094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67.7031" x="123" y="345.6426">RoleGuard</text></g><!--entity APIClient--><g class="entity" data-entity="APIClient" data-source-line="9" data-uid="ent0006" id="entity_APIClient"><rect fill="#F1F1F1" height="37.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="168.5928" x="106.5" y="437.1094"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="148.5928" x="116.5" y="461.6426">Cliente HTTP (lib/api.ts)</text></g><!--entity SecCfg--><g class="entity" data-entity="SecCfg" data-source-line="20" data-uid="ent0014" id="entity_SecCfg"><rect fill="#F1F1F1" height="37.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="111.041" x="324.5" y="668.4694"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="91.041" x="334.5" y="693.0026">SecurityConfig</text></g><!--entity JwtFilter--><g class="entity" data-entity="JwtFilter" data-source-line="21" data-uid="ent0015" id="entity_JwtFilter"><rect fill="#F1F1F1" height="37.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="160.8408" x="526.5" y="784.4694"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="140.8408" x="536.5" y="809.0026">JwtAuthenticationFilter</text></g><!--entity S--><g class="entity" data-entity="S" data-source-line="22" data-uid="ent0016" id="entity_S"><rect fill="#F1F1F1" height="37.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="73.6826" x="853" y="1059.4694"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="53.6826" x="863" y="1084.0026">Services</text></g><!--entity AuthController--><g class="entity" data-entity="AuthController" data-source-line="14" data-uid="ent0009" id="entity_AuthController"><rect fill="#F1F1F1" height="37.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="109.4893" x="352.5" y="938.4694"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89.4893" x="362.5" y="963.0026">AuthController</text></g><!--entity AdminController--><g class="entity" data-entity="AdminController" data-source-line="15" data-uid="ent0010" id="entity_AdminController"><rect fill="#F1F1F1" height="37.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="120.3721" x="497" y="938.4694"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="100.3721" x="507" y="963.0026">AdminController</text></g><!--entity MascotaController--><g class="entity" data-entity="MascotaController" data-source-line="16" data-uid="ent0011" id="entity_MascotaController"><rect fill="#F1F1F1" height="37.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="133.5996" x="652" y="938.4694"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113.5996" x="662" y="963.0026">MascotaController</text></g><!--entity CitaController--><g class="entity" data-entity="CitaController" data-source-line="17" data-uid="ent0012" id="entity_CitaController"><rect fill="#F1F1F1" height="37.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="105.5859" x="354" y="1059.4694"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="85.5859" x="364" y="1084.0026">CitaController</text></g><!--entity HealthController--><g class="entity" data-entity="HealthController" data-source-line="18" data-uid="ent0013" id="entity_HealthController"><rect fill="#F1F1F1" height="37.6094" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="121.1582" x="495.5" y="1059.4694"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="101.1582" x="505.5" y="1084.0026">HealthController</text></g><!--entity Usuario--><g class="entity" data-entity="Usuario" data-source-line="4" data-uid="ent0002" id="entity_Usuario"><ellipse cx="165.1206" cy="52.6094" fill="#F1F1F1" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M165.1206,60.6094 L165.1206,87.6094 M152.1206,68.6094 L178.1206,68.6094 M165.1206,87.6094 L152.1206,102.6094 M165.1206,87.6094 L178.1206,102.6094" fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="48.2412" x="141" y="118.6426">Usuario</text></g><!--entity DB--><g class="entity" data-entity="DB" data-source-line="25" data-uid="ent0017" id="entity_DB"><path d="M781.5,1243.4694 C781.5,1233.4694 889.9307,1233.4694 889.9307,1233.4694 C889.9307,1233.4694 998.3613,1233.4694 998.3613,1243.4694 L998.3613,1270.0788 C998.3613,1280.0788 889.9307,1280.0788 889.9307,1280.0788 C889.9307,1280.0788 781.5,1280.0788 781.5,1270.0788 L781.5,1243.4694" fill="#F1F1F1" style="stroke:#181818;stroke-width:0.5;"/><path d="M781.5,1243.4694 C781.5,1253.4694 889.9307,1253.4694 889.9307,1253.4694 C889.9307,1253.4694 998.3613,1253.4694 998.3613,1243.4694" fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="196.8613" x="791.5" y="1272.0026">DB (H2 dev / PostgreSQL prod)</text></g><!--entity Health--><g class="entity" data-entity="Health" data-source-line="37" data-uid="ent0027" id="entity_Health"><path d="M1005.5202,1062.5208 C1007.9848,1055.2566 1013.0118,1054.5894 1017.8527,1060.2541 C1021.3786,1052.5044 1026.4038,1050.8744 1032.5088,1057.6523 C1037.7363,1051.2838 1043.0566,1052.2312 1046.0526,1059.818 C1051.5813,1054.2597 1057.2486,1055.067 1059.8399,1062.8529 C1070.3551,1063.8397 1073.5131,1068.9376 1069.1209,1078.6711 C1073.4027,1087.7152 1071.3085,1094.4949 1060.5248,1096.1151 C1056.7905,1103.6889 1050.0986,1103.796 1045.561,1096.9486 C1042.076,1102.9317 1037.0482,1104.2174 1032.5423,1098.0419 C1026.5182,1103.8469 1022.0049,1102.8814 1018.1106,1095.6789 C1014.5366,1102.394 1007.8506,1103.311 1004.1307,1095.8224 C995.4511,1093.82 991.2205,1087.6494 998.1865,1079.8312 C991.7499,1070.0641 994.163,1064.7495 1005.5202,1062.5208" fill="#F1F1F1" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.4688" x="1011" y="1084.0026">Health</text></g><g class="entity" data-entity="GMN29" data-source-line="41" data-uid="ent0030" id="entity_GMN29"><path d="M6,564.4694 L6,590.8209 A0,0 0 0 0 6,590.8209 L264.4087,590.8209 A0,0 0 0 0 264.4087,590.8209 L264.4087,574.4694 L254.4087,564.4694 L144.68,564.4694 L182.49,475.2394 L136.68,564.4694 L6,564.4694 A0,0 0 0 0 6,564.4694" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M254.4087,564.4694 L254.4087,574.4694 L264.4087,574.4694 L254.4087,564.4694" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="237.4087" x="12" y="582.9645">401/403 &#8594; limpia token y redirige a /login</text></g><!--link Usuario to UI--><g class="link" data-entity-1="Usuario" data-entity-2="UI" data-source-line="27" data-uid="lnk18" id="link_Usuario_UI"><path d="M165,122.2694 C165,154.0194 165,191.8094 165,216.0794" fill="none" id="Usuario-to-UI" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="165,222.0794,169,213.0794,165,217.0794,161,213.0794,165,222.0794" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144.4727" x="166" y="166.6045">HTTP GET/POST (3000)</text></g><!--link UI to RoleGuard--><g class="link" data-entity-1="UI" data-entity-2="RoleGuard" data-source-line="28" data-uid="lnk19" id="link_UI_RoleGuard"><path d="M163.5,260.3494 C162.06,277.6994 160.4237,297.6497 158.9937,314.9697" fill="none" id="UI-to-RoleGuard" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="158.5,320.9494,163.227,312.309,158.9114,315.9663,155.2541,311.6508,158.5,320.9494" style="stroke:#181818;stroke-width:1;"/></g><!--link RoleGuard to APIClient--><g class="link" data-entity-1="RoleGuard" data-entity-2="APIClient" data-source-line="29" data-uid="lnk20" id="link_RoleGuard_APIClient"><path d="M162.39,359.1694 C168.72,380.3894 177.4438,409.66 183.8138,431" fill="none" id="RoleGuard-to-APIClient" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="185.53,436.7494,186.7886,426.9813,184.0999,431.9583,179.1229,429.2695,185.53,436.7494" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143.7744" x="177" y="403.6045">verifica rol (localStorage)</text></g><!--link APIClient to BE--><g class="link" data-entity-1="APIClient" data-entity-2="BE" data-source-line="30" data-uid="lnk21" id="link_APIClient_BE"><path d="M215.46,475.1094 C234.56,489.7194 261.24,511.3794 282,533.1094 C286.0525,537.3494 290.0775,542.0787 293.8506,546.8119 C294.3223,547.4035 294.79,547.9952 295.2533,548.586 C295.3691,548.7337 291.7911,544.153 291.9064,544.3006" fill="none" id="APIClient-to-BE" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="295.6,549.0289,293.2119,539.474,292.522,545.0886,286.9074,544.3988,295.6,549.0289" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="211.707" x="273" y="521.6045">fetch con JWT (http://localhost:8080)</text></g><!--link BE to SecCfg--><g class="link" data-entity-1="BE" data-entity-2="SecCfg" data-source-line="31" data-uid="lnk22" id="link_BE_SecCfg"><path d="M315.05,578.5494 C316.49,580.9494 347.7455,632.8889 365.8955,663.0389" fill="none" id="BE-to-SecCfg" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="368.99,668.1794,367.7752,658.4057,366.4113,663.8957,360.9213,662.5317,368.99,668.1794" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.8145" x="350" y="634.9645">SecurityFilterChain</text></g><!--link SecCfg to JwtFilter--><g class="link" data-entity-1="SecCfg" data-entity-2="JwtFilter" data-source-line="32" data-uid="lnk23" id="link_SecCfg_JwtFilter"><path d="M415.97,706.5294 C458.35,727.8194 522.9882,760.2765 565.4582,781.6065" fill="none" id="SecCfg-to-JwtFilter" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="570.82,784.2994,564.5726,776.6856,566.3519,782.0553,560.9821,783.8346,570.82,784.2994" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="64.3208" x="508" y="750.9645">a&#241;ade filtro</text></g><!--link JwtFilter to C--><g class="link" data-entity-1="JwtFilter" data-entity-2="C" data-source-line="33" data-uid="lnk24" id="link_JwtFilter_C"><path d="M687.8,816.9794 C727.47,827.1494 772.87,845.4994 802,878.4694 C804.86,881.7081 807.3059,885.3062 809.3962,889.1292 C809.9187,890.085 810.419,891.0548 810.898,892.0365 C811.1375,892.5274 811.3717,893.0212 811.6007,893.5178 C811.7151,893.7661 809.3743,888.5399 809.4862,888.7895" fill="none" id="JwtFilter-to-C" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="811.9402,894.2647,811.9093,884.4159,809.8952,889.702,804.609,887.6879,811.9402,894.2647" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121.3862" x="795" y="866.9645">inyecta principal y rol</text></g><!--link C to S--><g class="link" data-entity-1="C" data-entity-2="S" data-source-line="34" data-uid="lnk25" id="link_C_S"><path d="M829.1718,972.5626 C829.2389,972.6783 829.3063,972.7945 829.374,972.9113 C829.5095,973.145 829.6463,973.3808 829.7843,973.6189 C830.3365,974.5711 830.909,975.5584 831.5001,976.5778 C832.6823,978.6167 833.9391,980.784 835.2568,983.0566 C837.8923,987.6017 840.7716,992.5675 843.7863,997.7669 C855.845,1018.5644 867.0606,1037.9086 876.5106,1054.2086" fill="none" id="C-to-S" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="879.52,1059.3994,878.4665,1049.607,877.0122,1055.0738,871.5455,1053.6195,879.52,1059.3994" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101.188" x="858" y="1020.9645">l&#243;gica de negocio</text></g><!--link S to DB--><g class="link" data-entity-1="S" data-entity-2="DB" data-source-line="35" data-uid="lnk26" id="link_S_DB"><path d="M890,1097.6894 C890,1130.1894 890,1192.0594 890,1227.4294" fill="none" id="S-to-DB" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="890,1233.4294,894,1224.4294,890,1228.4294,886,1224.4294,890,1233.4294" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="23.8418" x="891" y="1199.9645">JPA</text></g><!--link C to Health--><g class="link" data-entity-1="C" data-entity-2="Health" data-source-line="38" data-uid="lnk28" id="link_C_Health"><path d="M829.13,959.7661 C829.5607,959.8401 830.0068,959.9175 830.4679,959.9983 C832.3121,960.3213 834.3954,960.6987 836.6908,961.1333 C845.8722,962.8716 858.4456,965.525 872.6737,969.2781 C901.13,976.7844 936.205,988.6894 964,1006.4694 C983.7,1019.0694 997.8822,1034.0339 1010.2322,1049.4739" fill="none" id="C-to-Health" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="1013.98,1054.1594,1011.482,1044.6326,1010.8568,1050.2548,1005.2346,1049.6296,1013.98,1054.1594" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="143.7935" x="986" y="1020.9645">GET /api/health (p&#250;blico)</text></g><!--SRC=[RLDBRXin3Dth58HNDefad3e50YyAs9C_-d4pThiekf0ryfYDB4qr7AT6aMqFq9iKtNMRc_GafKQkFqbNaiX7wl6Hh6xHbjBB1IYtA9tLbZ9Q6GrUAvAsC5eG4hy7_akDnCRQIyWktaFxZVvAXvyhU0PPwT4MC7IEEa98HSx3fAgbHoT4ATMjB3Iqphspf6s-ZJnwqMc1hE3y3Bu9s3A0rkGAseEoX1jNa_OHDRdQnzmueo_uaxpnRbxxeDGWdnekn-CHj0rE4rdY8LKnvM1q5G7YVeVea2yDpvswe7VOYp739sHJhiixOxIl6aJQ000-3cgQRvsVriPyWVQ9zRMib2Fvn9xYVuoNMfh7cU_tEMLQrHvfnQ0P5WqjDgMpOXzsVKU19DzHIK9dpz6mu0sUVV7rEBDVejAnr2m8bqkIKrcnSgT3Q5y-Xrml8O6HgwZmEdlt2ahlygZUwL28zMZ0mS5BRYhqOtCkpiR9w6qsXdQls-rs17i2ODlNpQsnRrh7yKljSSO50Cl1JNPAcenda9lP4LjSYEBczM6cISsv90lN7_YxEL7PJv8cRCwS-oVT4_wVeI4YgiPH_nIDcgHpYLQidG6tKOkXyk6dp3NC-EsTs7e2BcK_sbNOBWZZfR2K1bQ1kaZZZumm3x-AK11diRfmYXSfQvoiS1-kHmCXb75r3gqu2ussyRhE4XyCPbqX37qoZvPs-V1xQb0vNbNhU3McZiWjmCrsrk6uUvGSTtlmv_iFCBWeKG8vNef0LEVeaVT40cjMi0fXLqAclm00]--></g></svg>